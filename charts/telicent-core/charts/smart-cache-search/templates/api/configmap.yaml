{{- /*
Copyright (C) 2025 Telicent Limited
*/}}

apiVersion: v1
kind: ConfigMap

metadata:
  name: {{ include "smart-cache-search.fullname" . }}-api
  labels:
    {{- include "smart-cache-search.apiLabels" . | nindent 4 }}

data:
  # Environment variables for the search-api container
  USER_ATTRIBUTES_URL: {{ .Values.api.configuration.userAttributesUrl | quote }}
  ATTRIBUTE_HIERARCHY_URL: {{ .Values.api.configuration.attributeHierarchyUrl | quote }}
  JAVA_OPTIONS: {{ .Values.api.configuration.javaOptions | quote }}
  OTEL_METRICS_EXPORTER: {{ .Values.api.configuration.otelMetricsExporter | quote }}
  OTEL_TRACES_EXPORTER: {{ .Values.api.configuration.otelTracesExporter | quote }}
  ELASTIC_HOST: {{ .Values.api.configuration.elasticHost | quote }}
  ELASTIC_PORT: {{ .Values.api.configuration.elasticPort | quote }}
  ES_CLUSTER_PORT: {{ .Values.api.configuration.elasticClusterPort | quote }}
  OPENSEARCH_COMPATIBILITY: {{ .Values.api.configuration.opensearchCompatibility | quote }}
  ELASTIC_INDEX: {{ .Values.api.configuration.elasticIndexNames | quote }}
  FIELD_OPTIONS: {{ .Values.api.configuration.searchFieldOptions | quote }}
  JWKS_URL: {{ .Values.global.jwksUrl | quote }}
{{- with .Values.api.extraEnvs }}
{{- toYaml . | nindent 2 }}
{{- end }}
