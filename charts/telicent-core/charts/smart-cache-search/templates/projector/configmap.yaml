{{- /*
Copyright (C) 2025 Telicent Limited
*/}}

apiVersion: v1
kind: ConfigMap

metadata:
  name: {{ include "smart-cache-search.fullname" . }}-projector
  labels:
    {{- include "smart-cache-search.projectorLabels" . | nindent 4 }}

data:
  # Environment variables for the projector container
  JAVA_OPTIONS: {{ .Values.projector.configuration.javaOptions | quote }}
  OTEL_METRICS_EXPORTER: {{ .Values.projector.configuration.otelMetricsExporter | quote }}
  OTEL_TRACES_EXPORTER: {{ .Values.projector.configuration.otelTracesExporter | quote }}
  BOOTSTRAP_SERVERS: {{ .Values.global.kafkaBootstrapUrls | quote }}
  KAFKA_CONFIG_FILE_PATH: /app/config/kafka-auth/kafka-config.properties
  ELASTIC_HOST: {{ .Values.projector.configuration.elasticHost | quote }}
  ELASTIC_PORT: {{ .Values.projector.configuration.elasticPort | quote }}
  OPENSEARCH_COMPATIBILITY: {{ .Values.projector.configuration.opensearchCompatibility | quote }}
  ELASTIC_INDEX: {{ .Values.projector.configuration.elasticIndex | quote }}
  TOPIC: {{ .Values.projector.configuration.topic | quote }}
  DLQ_TOPIC: {{ .Values.projector.configuration.dlqTopic | quote }}
  INDEX_BATCH_SIZE: {{ .Values.projector.configuration.indexBatchSize | quote }}
  {{- with .Values.extraEnvs }}
  {{- toYaml . | nindent 2 }}
  {{- end }}
